<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SAL API: crypto_extra.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="kudelski.css" rel="stylesheet" type="text/css"/>
<link href="watermark.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="LOGO_IOT_IOTHINGS.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">SAL API
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('crypto__extra_8h_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">crypto_extra.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="crypto__extra_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160; </div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> *  Copyright The Mbed TLS Contributors</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> *  SPDX-License-Identifier: Apache-2.0 OR GPL-2.0-or-later</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160; </div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#ifndef PSA_CRYPTO_EXTRA_H</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#define PSA_CRYPTO_EXTRA_H</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="private__access_8h.html">mbedtls/private_access.h</a>&quot;</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160; </div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="crypto__types_8h.html">crypto_types.h</a>&quot;</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="crypto__compat_8h.html">crypto_compat.h</a>&quot;</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160; </div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#ifdef __cplusplus</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="keyword">extern</span> <span class="stringliteral">&quot;C&quot;</span> {</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160; </div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">/* UID for secure storage seed */</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#define PSA_CRYPTO_ITS_RANDOM_SEED_UID 0xFFFFFF52</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160; </div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">/* See mbedtls_config.h for definition */</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#if !defined(MBEDTLS_PSA_KEY_SLOT_COUNT)</span></div>
<div class="line"><a name="l00032"></a><span class="lineno"><a class="line" href="crypto__extra_8h.html#ad71d479d3f79388ebcef74fa0e070b5b">   32</a></span>&#160;<span class="preprocessor">#define MBEDTLS_PSA_KEY_SLOT_COUNT 32</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160; </div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> psa_set_key_enrollment_algorithm(</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <a class="code" href="structpsa__key__attributes__s.html">psa_key_attributes_t</a> *attributes,</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <a class="code" href="group__crypto__types.html#gac2e4d47f1300d73c2f829a6d99252d69">psa_algorithm_t</a> alg2)</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;{</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    attributes-&gt;MBEDTLS_PRIVATE(policy).MBEDTLS_PRIVATE(alg2) = alg2;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;}</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160; </div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <a class="code" href="group__crypto__types.html#gac2e4d47f1300d73c2f829a6d99252d69">psa_algorithm_t</a> psa_get_key_enrollment_algorithm(</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <span class="keyword">const</span> <a class="code" href="structpsa__key__attributes__s.html">psa_key_attributes_t</a> *attributes)</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;{</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <span class="keywordflow">return</span> attributes-&gt;MBEDTLS_PRIVATE(policy).MBEDTLS_PRIVATE(alg2);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;}</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160; </div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="preprocessor">#if defined(MBEDTLS_PSA_CRYPTO_SE_C)</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160; </div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<a class="code" href="group__error.html#ga05676e70ba5c6a7565aff3c36677c1f9">psa_status_t</a> psa_get_key_slot_number(</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="keyword">const</span> <a class="code" href="structpsa__key__attributes__s.html">psa_key_attributes_t</a> *attributes,</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <a class="code" href="group__se__init.html#ga90828ba6e282dd39260c81af68532e1d">psa_key_slot_number_t</a> *slot_number);</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160; </div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> psa_set_key_slot_number(</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <a class="code" href="structpsa__key__attributes__s.html">psa_key_attributes_t</a> *attributes,</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <a class="code" href="group__se__init.html#ga90828ba6e282dd39260c81af68532e1d">psa_key_slot_number_t</a> slot_number)</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;{</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    attributes-&gt;MBEDTLS_PRIVATE(has_slot_number) = 1;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    attributes-&gt;MBEDTLS_PRIVATE(slot_number) = slot_number;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;}</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160; </div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> psa_clear_key_slot_number(</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <a class="code" href="structpsa__key__attributes__s.html">psa_key_attributes_t</a> *attributes)</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;{</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    attributes-&gt;MBEDTLS_PRIVATE(has_slot_number) = 0;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;}</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160; </div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<a class="code" href="group__error.html#ga05676e70ba5c6a7565aff3c36677c1f9">psa_status_t</a> mbedtls_psa_register_se_key(</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <span class="keyword">const</span> <a class="code" href="structpsa__key__attributes__s.html">psa_key_attributes_t</a> *attributes);</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160; </div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* MBEDTLS_PSA_CRYPTO_SE_C */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160; </div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="keywordtype">void</span> <a class="code" href="crypto__extra_8h.html#a00f4837e0253580c83b4d93ea91aa48b">mbedtls_psa_crypto_free</a>(<span class="keywordtype">void</span>);</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160; </div>
<div class="line"><a name="l00221"></a><span class="lineno"><a class="line" href="structmbedtls__psa__stats__s.html">  221</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structmbedtls__psa__stats__s.html">mbedtls_psa_stats_s</a> {</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="structmbedtls__psa__stats__s.html#a7e4edf3d1ccd20d2b5d5bf1dc6255a97">MBEDTLS_PRIVATE</a>(volatile_slots);</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="structmbedtls__psa__stats__s.html#a7e4edf3d1ccd20d2b5d5bf1dc6255a97">MBEDTLS_PRIVATE</a>(persistent_slots);</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="structmbedtls__psa__stats__s.html#a7e4edf3d1ccd20d2b5d5bf1dc6255a97">MBEDTLS_PRIVATE</a>(external_slots);</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="structmbedtls__psa__stats__s.html#a7e4edf3d1ccd20d2b5d5bf1dc6255a97">MBEDTLS_PRIVATE</a>(half_filled_slots);</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="structmbedtls__psa__stats__s.html#a7e4edf3d1ccd20d2b5d5bf1dc6255a97">MBEDTLS_PRIVATE</a>(cache_slots);</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="structmbedtls__psa__stats__s.html#a7e4edf3d1ccd20d2b5d5bf1dc6255a97">MBEDTLS_PRIVATE</a>(empty_slots);</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="structmbedtls__psa__stats__s.html#a7e4edf3d1ccd20d2b5d5bf1dc6255a97">MBEDTLS_PRIVATE</a>(locked_slots);</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <a class="code" href="group__key__lifetimes.html#ga11e986351c65bd3dc3c0fe2cd9926e4b">psa_key_id_t</a> <a class="code" href="structmbedtls__psa__stats__s.html#a7e4edf3d1ccd20d2b5d5bf1dc6255a97">MBEDTLS_PRIVATE</a>(max_open_internal_key_id);</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <a class="code" href="group__key__lifetimes.html#ga11e986351c65bd3dc3c0fe2cd9926e4b">psa_key_id_t</a> <a class="code" href="structmbedtls__psa__stats__s.html#a7e4edf3d1ccd20d2b5d5bf1dc6255a97">MBEDTLS_PRIVATE</a>(max_open_external_key_id);</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;} <a class="code" href="crypto__extra_8h.html#aa9b95eb371f975f041d50f1a662357fe">mbedtls_psa_stats_t</a>;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160; </div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="keywordtype">void</span> <a class="code" href="crypto__extra_8h.html#aa4d160ae9c02a60317702832a828e4b7">mbedtls_psa_get_stats</a>(<a class="code" href="structmbedtls__psa__stats__s.html">mbedtls_psa_stats_t</a> *stats);</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160; </div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<a class="code" href="group__error.html#ga05676e70ba5c6a7565aff3c36677c1f9">psa_status_t</a> <a class="code" href="crypto__extra_8h.html#af4f09c8f08db9e2d881f465c432a300d">mbedtls_psa_inject_entropy</a>(<span class="keyword">const</span> uint8_t *seed,</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;                                        <span class="keywordtype">size_t</span> seed_size);</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160; </div>
<div class="line"><a name="l00337"></a><span class="lineno"><a class="line" href="group__crypto__types.html#ga5e7439c2905136366c3a876e62e5ddfc">  337</a></span>&#160;<span class="preprocessor">#define PSA_KEY_TYPE_DSA_PUBLIC_KEY                 ((psa_key_type_t) 0x4002)</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160; </div>
<div class="line"><a name="l00355"></a><span class="lineno"><a class="line" href="group__crypto__types.html#ga7d4a45c147cb0ecb55d01d9c04bfed76">  355</a></span>&#160;<span class="preprocessor">#define PSA_KEY_TYPE_DSA_KEY_PAIR                    ((psa_key_type_t) 0x7002)</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160; </div>
<div class="line"><a name="l00358"></a><span class="lineno"><a class="line" href="group__crypto__types.html#ga273fdfcf23eb0624f8b63d2321cf95c1">  358</a></span>&#160;<span class="preprocessor">#define PSA_KEY_TYPE_IS_DSA(type)                                       \</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="preprocessor">    (PSA_KEY_TYPE_PUBLIC_KEY_OF_KEY_PAIR(type) == PSA_KEY_TYPE_DSA_PUBLIC_KEY)</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160; </div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="preprocessor">#define PSA_ALG_DSA_BASE                        ((psa_algorithm_t) 0x06000400)</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160; </div>
<div class="line"><a name="l00376"></a><span class="lineno"><a class="line" href="group__crypto__types.html#ga9a68efdddff5ae95f104a1416b12742e">  376</a></span>&#160;<span class="preprocessor">#define PSA_ALG_DSA(hash_alg)                             \</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="preprocessor">    (PSA_ALG_DSA_BASE | ((hash_alg) &amp; PSA_ALG_HASH_MASK))</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="preprocessor">#define PSA_ALG_DETERMINISTIC_DSA_BASE          ((psa_algorithm_t) 0x06000500)</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="preprocessor">#define PSA_ALG_DSA_DETERMINISTIC_FLAG PSA_ALG_ECDSA_DETERMINISTIC_FLAG</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160; </div>
<div class="line"><a name="l00394"></a><span class="lineno"><a class="line" href="group__crypto__types.html#gab8eb98fb6d2e094e47f3b44dfe128f94">  394</a></span>&#160;<span class="preprocessor">#define PSA_ALG_DETERMINISTIC_DSA(hash_alg)                             \</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="preprocessor">    (PSA_ALG_DETERMINISTIC_DSA_BASE | ((hash_alg) &amp; PSA_ALG_HASH_MASK))</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="preprocessor">#define PSA_ALG_IS_DSA(alg)                                             \</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;<span class="preprocessor">    (((alg) &amp; ~PSA_ALG_HASH_MASK &amp; ~PSA_ALG_DSA_DETERMINISTIC_FLAG) ==  \</span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="preprocessor">     PSA_ALG_DSA_BASE)</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;<span class="preprocessor">#define PSA_ALG_DSA_IS_DETERMINISTIC(alg)               \</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="preprocessor">    (((alg) &amp; PSA_ALG_DSA_DETERMINISTIC_FLAG) != 0)</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<span class="preprocessor">#define PSA_ALG_IS_DETERMINISTIC_DSA(alg)                       \</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="preprocessor">    (PSA_ALG_IS_DSA(alg) &amp;&amp; PSA_ALG_DSA_IS_DETERMINISTIC(alg))</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;<span class="preprocessor">#define PSA_ALG_IS_RANDOMIZED_DSA(alg)                          \</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;<span class="preprocessor">    (PSA_ALG_IS_DSA(alg) &amp;&amp; !PSA_ALG_DSA_IS_DETERMINISTIC(alg))</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160; </div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160; </div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;<span class="comment">/* We need to expand the sample definition of this macro from</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;<span class="comment"> * the API definition. */</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="preprocessor">#undef PSA_ALG_IS_VENDOR_HASH_AND_SIGN</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<span class="preprocessor">#define PSA_ALG_IS_VENDOR_HASH_AND_SIGN(alg)    \</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;<span class="preprocessor">    PSA_ALG_IS_DSA(alg)</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160; </div>
<div class="line"><a name="l00420"></a><span class="lineno"><a class="line" href="group__attributes.html#ga36f877b443410900579cb552a782a530">  420</a></span>&#160;<span class="preprocessor">#define PSA_PAKE_OPERATION_STAGE_SETUP 0</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;<span class="preprocessor">#define PSA_PAKE_OPERATION_STAGE_COLLECT_INPUTS 1</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="preprocessor">#define PSA_PAKE_OPERATION_STAGE_COMPUTATION 2</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160; </div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="preprocessor">#if defined(MBEDTLS_PSA_CRYPTO_EXTERNAL_RNG)</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160; </div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;<a class="code" href="group__error.html#ga05676e70ba5c6a7565aff3c36677c1f9">psa_status_t</a> mbedtls_psa_external_get_random(</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    mbedtls_psa_external_random_context_t *context,</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    uint8_t *output, <span class="keywordtype">size_t</span> output_size, <span class="keywordtype">size_t</span> *output_length);</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* MBEDTLS_PSA_CRYPTO_EXTERNAL_RNG */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160; </div>
<div class="line"><a name="l00493"></a><span class="lineno"><a class="line" href="group__psa__builtin__keys.html#gaa0cdcd889aaaca7d78c378deb1e14353">  493</a></span>&#160;<span class="preprocessor">#define MBEDTLS_PSA_KEY_ID_BUILTIN_MIN          ((psa_key_id_t) 0x7fff0000)</span></div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160; </div>
<div class="line"><a name="l00500"></a><span class="lineno"><a class="line" href="group__psa__builtin__keys.html#ga0af04ffbbc3f6bc08562381205b8ef5e">  500</a></span>&#160;<span class="preprocessor">#define MBEDTLS_PSA_KEY_ID_BUILTIN_MAX          ((psa_key_id_t) 0x7fffefff)</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160; </div>
<div class="line"><a name="l00506"></a><span class="lineno"><a class="line" href="group__psa__builtin__keys.html#ga1eb805bebc295cc2f7132679fa85d43d">  506</a></span>&#160;<span class="keyword">typedef</span> uint64_t <a class="code" href="group__psa__builtin__keys.html#ga1eb805bebc295cc2f7132679fa85d43d">psa_drv_slot_number_t</a>;</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160; </div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;<span class="preprocessor">#if defined(MBEDTLS_PSA_CRYPTO_BUILTIN_KEYS)</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160; </div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> psa_key_id_is_builtin(<a class="code" href="group__key__lifetimes.html#ga11e986351c65bd3dc3c0fe2cd9926e4b">psa_key_id_t</a> key_id)</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;{</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    <span class="keywordflow">return</span> (key_id &gt;= <a class="code" href="group__psa__builtin__keys.html#gaa0cdcd889aaaca7d78c378deb1e14353">MBEDTLS_PSA_KEY_ID_BUILTIN_MIN</a>) &amp;&amp;</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;           (key_id &lt;= <a class="code" href="group__psa__builtin__keys.html#ga0af04ffbbc3f6bc08562381205b8ef5e">MBEDTLS_PSA_KEY_ID_BUILTIN_MAX</a>);</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;}</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160; </div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;<a class="code" href="group__error.html#ga05676e70ba5c6a7565aff3c36677c1f9">psa_status_t</a> mbedtls_psa_platform_get_builtin_key(</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    <a class="code" href="group__key__lifetimes.html#ga9a5375bd0cb9694f3a2694adc0a6ae13">mbedtls_svc_key_id_t</a> key_id,</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    <a class="code" href="group__key__lifetimes.html#ga6821ff6dd39dc2bc370ded760ad8b0cf">psa_key_lifetime_t</a> *lifetime,</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    <a class="code" href="group__psa__builtin__keys.html#ga1eb805bebc295cc2f7132679fa85d43d">psa_drv_slot_number_t</a> *slot_number);</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* MBEDTLS_PSA_CRYPTO_BUILTIN_KEYS */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160; </div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;<span class="preprocessor">#define PSA_ALG_CATEGORY_PAKE                   ((psa_algorithm_t) 0x0a000000)</span></div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160; </div>
<div class="line"><a name="l00591"></a><span class="lineno"><a class="line" href="group__crypto__types.html#ga947bd13805e0243541e586b7b7d803ae">  591</a></span>&#160;<span class="preprocessor">#define PSA_ALG_IS_PAKE(alg)                                        \</span></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;<span class="preprocessor">    (((alg) &amp; PSA_ALG_CATEGORY_MASK) == PSA_ALG_CATEGORY_PAKE)</span></div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160; </div>
<div class="line"><a name="l00709"></a><span class="lineno"><a class="line" href="group__crypto__types.html#gaa2ae65388d11e23b3676570337a69926">  709</a></span>&#160;<span class="preprocessor">#define PSA_ALG_JPAKE                   ((psa_algorithm_t) 0x0a000100)</span></div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160; </div>
<div class="line"><a name="l00731"></a><span class="lineno"><a class="line" href="group__pake.html#gab1769b1b1a85111973e8d0c9cced95de">  731</a></span>&#160;<span class="keyword">typedef</span> uint8_t <a class="code" href="group__pake.html#gab1769b1b1a85111973e8d0c9cced95de">psa_pake_role_t</a>;</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160; </div>
<div class="line"><a name="l00739"></a><span class="lineno"><a class="line" href="group__pake.html#gac16be59e5b1acb89c26709eed001ef35">  739</a></span>&#160;<span class="keyword">typedef</span> uint8_t <a class="code" href="group__pake.html#gac16be59e5b1acb89c26709eed001ef35">psa_pake_step_t</a>;</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160; </div>
<div class="line"><a name="l00749"></a><span class="lineno"><a class="line" href="group__pake.html#gad8b29b6efa90ad2887d7b1252d23e5bc">  749</a></span>&#160;<span class="keyword">typedef</span> uint8_t <a class="code" href="group__pake.html#gad8b29b6efa90ad2887d7b1252d23e5bc">psa_pake_primitive_type_t</a>;</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160; </div>
<div class="line"><a name="l00756"></a><span class="lineno"><a class="line" href="group__pake.html#gae20cc74390755f28b6f2b893a936d893">  756</a></span>&#160;<span class="keyword">typedef</span> uint8_t <a class="code" href="group__pake.html#gae20cc74390755f28b6f2b893a936d893">psa_pake_family_t</a>;</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160; </div>
<div class="line"><a name="l00762"></a><span class="lineno"><a class="line" href="group__pake.html#ga37ed4ea6bba6bacc72d0ecb9b95af96c">  762</a></span>&#160;<span class="keyword">typedef</span> uint32_t <a class="code" href="group__pake.html#ga37ed4ea6bba6bacc72d0ecb9b95af96c">psa_pake_primitive_t</a>;</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160; </div>
<div class="line"><a name="l00768"></a><span class="lineno"><a class="line" href="group__pake.html#ga7cd915c229c3d4aad5bd3bf7b8ad847b">  768</a></span>&#160;<span class="preprocessor">#define PSA_PAKE_ROLE_NONE                  ((psa_pake_role_t) 0x00)</span></div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160; </div>
<div class="line"><a name="l00777"></a><span class="lineno"><a class="line" href="group__pake.html#ga7698f576ae0a65a4066902c53cd4e0be">  777</a></span>&#160;<span class="preprocessor">#define PSA_PAKE_ROLE_FIRST                ((psa_pake_role_t) 0x01)</span></div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160; </div>
<div class="line"><a name="l00786"></a><span class="lineno"><a class="line" href="group__pake.html#ga3584fa3033dbdb6ca7c0c6fe67da7307">  786</a></span>&#160;<span class="preprocessor">#define PSA_PAKE_ROLE_SECOND                ((psa_pake_role_t) 0x02)</span></div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160; </div>
<div class="line"><a name="l00792"></a><span class="lineno"><a class="line" href="group__pake.html#gaa7b37df16153c98153a4b2bd9686b40e">  792</a></span>&#160;<span class="preprocessor">#define PSA_PAKE_ROLE_CLIENT                ((psa_pake_role_t) 0x11)</span></div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160; </div>
<div class="line"><a name="l00798"></a><span class="lineno"><a class="line" href="group__pake.html#ga9daddaf54cafd4513431cfd5e0148aff">  798</a></span>&#160;<span class="preprocessor">#define PSA_PAKE_ROLE_SERVER                ((psa_pake_role_t) 0x12)</span></div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160; </div>
<div class="line"><a name="l00818"></a><span class="lineno"><a class="line" href="group__pake.html#ga6da014bd15742c5463bf32c7759788d0">  818</a></span>&#160;<span class="preprocessor">#define PSA_PAKE_PRIMITIVE_TYPE_ECC       ((psa_pake_primitive_type_t) 0x01)</span></div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160; </div>
<div class="line"><a name="l00838"></a><span class="lineno"><a class="line" href="group__pake.html#ga96803ecc85799a0d070861b9f86d579f">  838</a></span>&#160;<span class="preprocessor">#define PSA_PAKE_PRIMITIVE_TYPE_DH       ((psa_pake_primitive_type_t) 0x02)</span></div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160; </div>
<div class="line"><a name="l00859"></a><span class="lineno"><a class="line" href="group__pake.html#gaf49527ceec65d3927f4ef2a589bade04">  859</a></span>&#160;<span class="preprocessor">#define PSA_PAKE_PRIMITIVE(pake_type, pake_family, pake_bits) \</span></div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;<span class="preprocessor">    ((pake_bits &amp; 0xFFFF) != pake_bits) ? 0 :                 \</span></div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;<span class="preprocessor">    ((psa_pake_primitive_t) (((pake_type) &lt;&lt; 24 |             \</span></div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;<span class="preprocessor">                              (pake_family) &lt;&lt; 16) | (pake_bits)))</span></div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160; </div>
<div class="line"><a name="l00876"></a><span class="lineno"><a class="line" href="group__pake.html#ga043357cc339a34134089e9c8be93bfdb">  876</a></span>&#160;<span class="preprocessor">#define PSA_PAKE_STEP_KEY_SHARE                 ((psa_pake_step_t) 0x01)</span></div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160; </div>
<div class="line"><a name="l00893"></a><span class="lineno"><a class="line" href="group__pake.html#gaeb14d80e6d8a0716ed04d42dcc94af82">  893</a></span>&#160;<span class="preprocessor">#define PSA_PAKE_STEP_ZK_PUBLIC                 ((psa_pake_step_t) 0x02)</span></div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160; </div>
<div class="line"><a name="l00914"></a><span class="lineno"><a class="line" href="group__pake.html#ga8b483c7638f927f1c858cfcfe32569f9">  914</a></span>&#160;<span class="preprocessor">#define PSA_PAKE_STEP_ZK_PROOF                  ((psa_pake_step_t) 0x03)</span></div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160; </div>
<div class="line"><a name="l00922"></a><span class="lineno"><a class="line" href="group__pake.html#ga11606af917145770bbdb0ae16adf7704">  922</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structpsa__pake__cipher__suite__s.html">psa_pake_cipher_suite_s</a> <a class="code" href="structpsa__pake__cipher__suite__s.html">psa_pake_cipher_suite_t</a>;</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160; </div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;<span class="keyword">static</span> <a class="code" href="structpsa__pake__cipher__suite__s.html">psa_pake_cipher_suite_t</a> psa_pake_cipher_suite_init(<span class="keywordtype">void</span>);</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160; </div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;<span class="keyword">static</span> <a class="code" href="group__crypto__types.html#gac2e4d47f1300d73c2f829a6d99252d69">psa_algorithm_t</a> psa_pake_cs_get_algorithm(</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;    <span class="keyword">const</span> <a class="code" href="structpsa__pake__cipher__suite__s.html">psa_pake_cipher_suite_t</a> *cipher_suite);</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160; </div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> psa_pake_cs_set_algorithm(<a class="code" href="structpsa__pake__cipher__suite__s.html">psa_pake_cipher_suite_t</a> *cipher_suite,</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;                                      <a class="code" href="group__crypto__types.html#gac2e4d47f1300d73c2f829a6d99252d69">psa_algorithm_t</a> algorithm);</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160; </div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;<span class="keyword">static</span> <a class="code" href="group__pake.html#ga37ed4ea6bba6bacc72d0ecb9b95af96c">psa_pake_primitive_t</a> psa_pake_cs_get_primitive(</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;    <span class="keyword">const</span> <a class="code" href="structpsa__pake__cipher__suite__s.html">psa_pake_cipher_suite_t</a> *cipher_suite);</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160; </div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> psa_pake_cs_set_primitive(<a class="code" href="structpsa__pake__cipher__suite__s.html">psa_pake_cipher_suite_t</a> *cipher_suite,</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;                                      <a class="code" href="group__pake.html#ga37ed4ea6bba6bacc72d0ecb9b95af96c">psa_pake_primitive_t</a> primitive);</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160; </div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;<span class="keyword">static</span> <a class="code" href="group__pake.html#gae20cc74390755f28b6f2b893a936d893">psa_pake_family_t</a> psa_pake_cs_get_family(</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;    <span class="keyword">const</span> <a class="code" href="structpsa__pake__cipher__suite__s.html">psa_pake_cipher_suite_t</a> *cipher_suite);</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160; </div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;<span class="keyword">static</span> uint16_t psa_pake_cs_get_bits(</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;    <span class="keyword">const</span> <a class="code" href="structpsa__pake__cipher__suite__s.html">psa_pake_cipher_suite_t</a> *cipher_suite);</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160; </div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;<span class="keyword">static</span> <a class="code" href="group__crypto__types.html#gac2e4d47f1300d73c2f829a6d99252d69">psa_algorithm_t</a> psa_pake_cs_get_hash(</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;    <span class="keyword">const</span> <a class="code" href="structpsa__pake__cipher__suite__s.html">psa_pake_cipher_suite_t</a> *cipher_suite);</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160; </div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> psa_pake_cs_set_hash(<a class="code" href="structpsa__pake__cipher__suite__s.html">psa_pake_cipher_suite_t</a> *cipher_suite,</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;                                 <a class="code" href="group__crypto__types.html#gac2e4d47f1300d73c2f829a6d99252d69">psa_algorithm_t</a> hash);</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160; </div>
<div class="line"><a name="l01049"></a><span class="lineno"><a class="line" href="group__pake.html#ga2b408ef3a7b22400e4590a2c98a503df"> 1049</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structpsa__pake__operation__s.html">psa_pake_operation_s</a> <a class="code" href="structpsa__pake__operation__s.html">psa_pake_operation_t</a>;</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160; </div>
<div class="line"><a name="l01052"></a><span class="lineno"><a class="line" href="group__pake.html#ga9d068eac66ccd7bca819fc27d078ea90"> 1052</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structpsa__crypto__driver__pake__inputs__s.html">psa_crypto_driver_pake_inputs_s</a> <a class="code" href="structpsa__crypto__driver__pake__inputs__s.html">psa_crypto_driver_pake_inputs_t</a>;</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160; </div>
<div class="line"><a name="l01055"></a><span class="lineno"><a class="line" href="group__pake.html#gadc25d4b129165e849dfc95dc8b5e3085"> 1055</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structpsa__jpake__computation__stage__s.html">psa_jpake_computation_stage_s</a> <a class="code" href="structpsa__jpake__computation__stage__s.html">psa_jpake_computation_stage_t</a>;</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160; </div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;<span class="keyword">static</span> <a class="code" href="structpsa__pake__operation__s.html">psa_pake_operation_t</a> psa_pake_operation_init(<span class="keywordtype">void</span>);</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160; </div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;<a class="code" href="group__error.html#ga05676e70ba5c6a7565aff3c36677c1f9">psa_status_t</a> <a class="code" href="group__pake.html#ga8fe36328c35f9f8b399492d369ab5d1d">psa_crypto_driver_pake_get_password_len</a>(</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;    <span class="keyword">const</span> <a class="code" href="structpsa__crypto__driver__pake__inputs__s.html">psa_crypto_driver_pake_inputs_t</a> *inputs,</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;    <span class="keywordtype">size_t</span> *password_len);</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160; </div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;<a class="code" href="group__error.html#ga05676e70ba5c6a7565aff3c36677c1f9">psa_status_t</a> <a class="code" href="group__pake.html#ga2476026b61583d8e9321256e5bfe5392">psa_crypto_driver_pake_get_password</a>(</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;    <span class="keyword">const</span> <a class="code" href="structpsa__crypto__driver__pake__inputs__s.html">psa_crypto_driver_pake_inputs_t</a> *inputs,</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;    uint8_t *buffer, <span class="keywordtype">size_t</span> buffer_size, <span class="keywordtype">size_t</span> *buffer_length);</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160; </div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;<a class="code" href="group__error.html#ga05676e70ba5c6a7565aff3c36677c1f9">psa_status_t</a> <a class="code" href="group__pake.html#gae0a816b989d5ee3a6b3fe8ceac544875">psa_crypto_driver_pake_get_user_len</a>(</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;    <span class="keyword">const</span> <a class="code" href="structpsa__crypto__driver__pake__inputs__s.html">psa_crypto_driver_pake_inputs_t</a> *inputs,</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;    <span class="keywordtype">size_t</span> *user_len);</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160; </div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;<a class="code" href="group__error.html#ga05676e70ba5c6a7565aff3c36677c1f9">psa_status_t</a> <a class="code" href="group__pake.html#gadcf0335780b48a4851780807e115b20e">psa_crypto_driver_pake_get_peer_len</a>(</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;    <span class="keyword">const</span> <a class="code" href="structpsa__crypto__driver__pake__inputs__s.html">psa_crypto_driver_pake_inputs_t</a> *inputs,</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;    <span class="keywordtype">size_t</span> *peer_len);</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160; </div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;<a class="code" href="group__error.html#ga05676e70ba5c6a7565aff3c36677c1f9">psa_status_t</a> <a class="code" href="group__pake.html#gaeeeb55c935dc95819bae1378de462593">psa_crypto_driver_pake_get_user</a>(</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;    <span class="keyword">const</span> <a class="code" href="structpsa__crypto__driver__pake__inputs__s.html">psa_crypto_driver_pake_inputs_t</a> *inputs,</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;    uint8_t *user_id, <span class="keywordtype">size_t</span> user_id_size, <span class="keywordtype">size_t</span> *user_id_len);</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160; </div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;<a class="code" href="group__error.html#ga05676e70ba5c6a7565aff3c36677c1f9">psa_status_t</a> <a class="code" href="group__pake.html#gac21aace2d63ba9766e8266e3bd782d12">psa_crypto_driver_pake_get_peer</a>(</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;    <span class="keyword">const</span> <a class="code" href="structpsa__crypto__driver__pake__inputs__s.html">psa_crypto_driver_pake_inputs_t</a> *inputs,</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;    uint8_t *peer_id, <span class="keywordtype">size_t</span> peer_id_size, <span class="keywordtype">size_t</span> *peer_id_length);</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160; </div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;<a class="code" href="group__error.html#ga05676e70ba5c6a7565aff3c36677c1f9">psa_status_t</a> <a class="code" href="group__pake.html#gafb67c744b4ef6615dce729b6c88b9638">psa_crypto_driver_pake_get_cipher_suite</a>(</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;    <span class="keyword">const</span> <a class="code" href="structpsa__crypto__driver__pake__inputs__s.html">psa_crypto_driver_pake_inputs_t</a> *inputs,</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;    <a class="code" href="structpsa__pake__cipher__suite__s.html">psa_pake_cipher_suite_t</a> *cipher_suite);</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160; </div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;<a class="code" href="group__error.html#ga05676e70ba5c6a7565aff3c36677c1f9">psa_status_t</a> <a class="code" href="group__pake.html#ga45e914c064160f4fe1d511f9d0506400">psa_pake_setup</a>(<a class="code" href="structpsa__pake__operation__s.html">psa_pake_operation_t</a> *operation,</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;                            <span class="keyword">const</span> <a class="code" href="structpsa__pake__cipher__suite__s.html">psa_pake_cipher_suite_t</a> *cipher_suite);</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160; </div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;<a class="code" href="group__error.html#ga05676e70ba5c6a7565aff3c36677c1f9">psa_status_t</a> <a class="code" href="group__pake.html#ga070417b83e6d602e9a6cc6748a14ea91">psa_pake_set_password_key</a>(<a class="code" href="structpsa__pake__operation__s.html">psa_pake_operation_t</a> *operation,</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;                                       <a class="code" href="group__key__lifetimes.html#ga9a5375bd0cb9694f3a2694adc0a6ae13">mbedtls_svc_key_id_t</a> password);</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160; </div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;<a class="code" href="group__error.html#ga05676e70ba5c6a7565aff3c36677c1f9">psa_status_t</a> <a class="code" href="group__pake.html#ga64fe9f62b09d39056e169325a9d33aac">psa_pake_set_user</a>(<a class="code" href="structpsa__pake__operation__s.html">psa_pake_operation_t</a> *operation,</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;                               <span class="keyword">const</span> uint8_t *user_id,</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;                               <span class="keywordtype">size_t</span> user_id_len);</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160; </div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;<a class="code" href="group__error.html#ga05676e70ba5c6a7565aff3c36677c1f9">psa_status_t</a> <a class="code" href="group__pake.html#gabae9a3e54d1c895032a4ee543b494958">psa_pake_set_peer</a>(<a class="code" href="structpsa__pake__operation__s.html">psa_pake_operation_t</a> *operation,</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;                               <span class="keyword">const</span> uint8_t *peer_id,</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;                               <span class="keywordtype">size_t</span> peer_id_len);</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160; </div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;<a class="code" href="group__error.html#ga05676e70ba5c6a7565aff3c36677c1f9">psa_status_t</a> <a class="code" href="group__pake.html#gaf61d9d1549d4f3eeaf891dd73354db66">psa_pake_set_role</a>(<a class="code" href="structpsa__pake__operation__s.html">psa_pake_operation_t</a> *operation,</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;                               <a class="code" href="group__pake.html#gab1769b1b1a85111973e8d0c9cced95de">psa_pake_role_t</a> role);</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160; </div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;<a class="code" href="group__error.html#ga05676e70ba5c6a7565aff3c36677c1f9">psa_status_t</a> <a class="code" href="group__pake.html#ga592e6102db23692862d800f569a8f1fe">psa_pake_output</a>(<a class="code" href="structpsa__pake__operation__s.html">psa_pake_operation_t</a> *operation,</div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;                             <a class="code" href="group__pake.html#gac16be59e5b1acb89c26709eed001ef35">psa_pake_step_t</a> step,</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;                             uint8_t *output,</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;                             <span class="keywordtype">size_t</span> output_size,</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;                             <span class="keywordtype">size_t</span> *output_length);</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160; </div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;<a class="code" href="group__error.html#ga05676e70ba5c6a7565aff3c36677c1f9">psa_status_t</a> <a class="code" href="group__pake.html#ga35af752a83762fe23daa47e3ddef3a68">psa_pake_input</a>(<a class="code" href="structpsa__pake__operation__s.html">psa_pake_operation_t</a> *operation,</div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;                            <a class="code" href="group__pake.html#gac16be59e5b1acb89c26709eed001ef35">psa_pake_step_t</a> step,</div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;                            <span class="keyword">const</span> uint8_t *input,</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;                            <span class="keywordtype">size_t</span> input_length);</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160; </div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;<a class="code" href="group__error.html#ga05676e70ba5c6a7565aff3c36677c1f9">psa_status_t</a> <a class="code" href="group__pake.html#gae1e7c28c10bf767f4b6927f820740103">psa_pake_get_implicit_key</a>(<a class="code" href="structpsa__pake__operation__s.html">psa_pake_operation_t</a> *operation,</div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;                                       <a class="code" href="structpsa__key__derivation__s.html">psa_key_derivation_operation_t</a> *output);</div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160; </div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;<a class="code" href="group__error.html#ga05676e70ba5c6a7565aff3c36677c1f9">psa_status_t</a> <a class="code" href="group__pake.html#ga20bed96cc254d2e1829d666edc74376a">psa_pake_abort</a>(<a class="code" href="structpsa__pake__operation__s.html">psa_pake_operation_t</a> *operation);</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160; </div>
<div class="line"><a name="l01638"></a><span class="lineno"><a class="line" href="crypto__extra_8h.html#a50919659323674b8d803621d8eb51268"> 1638</a></span>&#160;<span class="preprocessor">#define PSA_PAKE_OUTPUT_SIZE(alg, primitive, output_step)               \</span></div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;<span class="preprocessor">    (alg == PSA_ALG_JPAKE &amp;&amp;                                           \</span></div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;<span class="preprocessor">     primitive == PSA_PAKE_PRIMITIVE(PSA_PAKE_PRIMITIVE_TYPE_ECC,      \</span></div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;<span class="preprocessor">                                     PSA_ECC_FAMILY_SECP_R1, 256) ?    \</span></div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;<span class="preprocessor">     (                                                                 \</span></div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;<span class="preprocessor">         output_step == PSA_PAKE_STEP_KEY_SHARE ? 65 :                   \</span></div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;<span class="preprocessor">         output_step == PSA_PAKE_STEP_ZK_PUBLIC ? 65 :                   \</span></div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;<span class="preprocessor">         32                                                              \</span></div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;<span class="preprocessor">     ) :                                                               \</span></div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;<span class="preprocessor">     0)</span></div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160; </div>
<div class="line"><a name="l01668"></a><span class="lineno"><a class="line" href="crypto__extra_8h.html#a83988684b5f8206af1121f51e30a71fc"> 1668</a></span>&#160;<span class="preprocessor">#define PSA_PAKE_INPUT_SIZE(alg, primitive, input_step)                 \</span></div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;<span class="preprocessor">    (alg == PSA_ALG_JPAKE &amp;&amp;                                           \</span></div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;<span class="preprocessor">     primitive == PSA_PAKE_PRIMITIVE(PSA_PAKE_PRIMITIVE_TYPE_ECC,      \</span></div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;<span class="preprocessor">                                     PSA_ECC_FAMILY_SECP_R1, 256) ?    \</span></div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;<span class="preprocessor">     (                                                                 \</span></div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;<span class="preprocessor">         input_step == PSA_PAKE_STEP_KEY_SHARE ? 65 :                    \</span></div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;<span class="preprocessor">         input_step == PSA_PAKE_STEP_ZK_PUBLIC ? 65 :                    \</span></div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;<span class="preprocessor">         32                                                              \</span></div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;<span class="preprocessor">     ) :                                                               \</span></div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;<span class="preprocessor">     0)</span></div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160; </div>
<div class="line"><a name="l01689"></a><span class="lineno"><a class="line" href="crypto__extra_8h.html#a878628cebacd7123211337da96fcd1db"> 1689</a></span>&#160;<span class="preprocessor">#define PSA_PAKE_OUTPUT_MAX_SIZE 65</span></div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160; </div>
<div class="line"><a name="l01701"></a><span class="lineno"><a class="line" href="crypto__extra_8h.html#aa9bc89c6c98e76ccbfcecd7d44d6f3b0"> 1701</a></span>&#160;<span class="preprocessor">#define PSA_PAKE_INPUT_MAX_SIZE 65</span></div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160; </div>
<div class="line"><a name="l01706"></a><span class="lineno"><a class="line" href="crypto__extra_8h.html#a78e33eb5906aa452ca64159191c2d975"> 1706</a></span>&#160;<span class="preprocessor">#define PSA_PAKE_CIPHER_SUITE_INIT { PSA_ALG_NONE, 0, 0, 0, PSA_ALG_NONE }</span></div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160; </div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;<span class="preprocessor">#if defined(MBEDTLS_PSA_CRYPTO_CLIENT) &amp;&amp; !defined(MBEDTLS_PSA_CRYPTO_C)</span></div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;<span class="preprocessor">#define PSA_PAKE_OPERATION_INIT { 0 }</span></div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l01714"></a><span class="lineno"><a class="line" href="crypto__extra_8h.html#a0ce235183de6d1a0744b00ced5be7c74"> 1714</a></span>&#160;<span class="preprocessor">#define PSA_PAKE_OPERATION_INIT { 0, PSA_ALG_NONE, 0, PSA_PAKE_OPERATION_STAGE_SETUP, \</span></div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;<span class="preprocessor">                                  { 0 }, { { 0 } } }</span></div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160; </div>
<div class="line"><a name="l01718"></a><span class="lineno"><a class="line" href="structpsa__pake__cipher__suite__s.html"> 1718</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structpsa__pake__cipher__suite__s.html">psa_pake_cipher_suite_s</a> {</div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;    <a class="code" href="group__crypto__types.html#gac2e4d47f1300d73c2f829a6d99252d69">psa_algorithm_t</a> algorithm;</div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;    <a class="code" href="group__pake.html#gad8b29b6efa90ad2887d7b1252d23e5bc">psa_pake_primitive_type_t</a> type;</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;    <a class="code" href="group__pake.html#gae20cc74390755f28b6f2b893a936d893">psa_pake_family_t</a> family;</div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;    uint16_t  bits;</div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;    <a class="code" href="group__crypto__types.html#gac2e4d47f1300d73c2f829a6d99252d69">psa_algorithm_t</a> hash;</div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;};</div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160; </div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <a class="code" href="group__crypto__types.html#gac2e4d47f1300d73c2f829a6d99252d69">psa_algorithm_t</a> psa_pake_cs_get_algorithm(</div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;    <span class="keyword">const</span> <a class="code" href="structpsa__pake__cipher__suite__s.html">psa_pake_cipher_suite_t</a> *cipher_suite)</div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;{</div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;    <span class="keywordflow">return</span> cipher_suite-&gt;algorithm;</div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;}</div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160; </div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> psa_pake_cs_set_algorithm(</div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;    <a class="code" href="structpsa__pake__cipher__suite__s.html">psa_pake_cipher_suite_t</a> *cipher_suite,</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;    <a class="code" href="group__crypto__types.html#gac2e4d47f1300d73c2f829a6d99252d69">psa_algorithm_t</a> algorithm)</div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;{</div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="group__crypto__types.html#ga947bd13805e0243541e586b7b7d803ae">PSA_ALG_IS_PAKE</a>(algorithm)) {</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;        cipher_suite-&gt;algorithm = 0;</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;        cipher_suite-&gt;algorithm = algorithm;</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;    }</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;}</div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160; </div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <a class="code" href="group__pake.html#ga37ed4ea6bba6bacc72d0ecb9b95af96c">psa_pake_primitive_t</a> psa_pake_cs_get_primitive(</div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;    <span class="keyword">const</span> <a class="code" href="structpsa__pake__cipher__suite__s.html">psa_pake_cipher_suite_t</a> *cipher_suite)</div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;{</div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="group__pake.html#gaf49527ceec65d3927f4ef2a589bade04">PSA_PAKE_PRIMITIVE</a>(cipher_suite-&gt;type, cipher_suite-&gt;family,</div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;                              cipher_suite-&gt;bits);</div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;}</div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160; </div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> psa_pake_cs_set_primitive(</div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;    <a class="code" href="structpsa__pake__cipher__suite__s.html">psa_pake_cipher_suite_t</a> *cipher_suite,</div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;    <a class="code" href="group__pake.html#ga37ed4ea6bba6bacc72d0ecb9b95af96c">psa_pake_primitive_t</a> primitive)</div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;{</div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;    cipher_suite-&gt;type = (<a class="code" href="group__pake.html#gad8b29b6efa90ad2887d7b1252d23e5bc">psa_pake_primitive_type_t</a>) (primitive &gt;&gt; 24);</div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;    cipher_suite-&gt;family = (<a class="code" href="group__pake.html#gae20cc74390755f28b6f2b893a936d893">psa_pake_family_t</a>) (0xFF &amp; (primitive &gt;&gt; 16));</div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;    cipher_suite-&gt;bits = (uint16_t) (0xFFFF &amp; primitive);</div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;}</div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160; </div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <a class="code" href="group__pake.html#gae20cc74390755f28b6f2b893a936d893">psa_pake_family_t</a> psa_pake_cs_get_family(</div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;    <span class="keyword">const</span> <a class="code" href="structpsa__pake__cipher__suite__s.html">psa_pake_cipher_suite_t</a> *cipher_suite)</div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;{</div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;    <span class="keywordflow">return</span> cipher_suite-&gt;family;</div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;}</div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160; </div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> uint16_t psa_pake_cs_get_bits(</div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;    <span class="keyword">const</span> <a class="code" href="structpsa__pake__cipher__suite__s.html">psa_pake_cipher_suite_t</a> *cipher_suite)</div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;{</div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;    <span class="keywordflow">return</span> cipher_suite-&gt;bits;</div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;}</div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160; </div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <a class="code" href="group__crypto__types.html#gac2e4d47f1300d73c2f829a6d99252d69">psa_algorithm_t</a> psa_pake_cs_get_hash(</div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;    <span class="keyword">const</span> <a class="code" href="structpsa__pake__cipher__suite__s.html">psa_pake_cipher_suite_t</a> *cipher_suite)</div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;{</div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;    <span class="keywordflow">return</span> cipher_suite-&gt;hash;</div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;}</div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160; </div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> psa_pake_cs_set_hash(<a class="code" href="structpsa__pake__cipher__suite__s.html">psa_pake_cipher_suite_t</a> *cipher_suite,</div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;                                        <a class="code" href="group__crypto__types.html#gac2e4d47f1300d73c2f829a6d99252d69">psa_algorithm_t</a> hash)</div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;{</div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="group__crypto__types.html#gac9280662bb482590b4b33d1dcd32930f">PSA_ALG_IS_HASH</a>(hash)) {</div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;        cipher_suite-&gt;hash = 0;</div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;        cipher_suite-&gt;hash = hash;</div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;    }</div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;}</div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160; </div>
<div class="line"><a name="l01787"></a><span class="lineno"><a class="line" href="structpsa__crypto__driver__pake__inputs__s.html"> 1787</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structpsa__crypto__driver__pake__inputs__s.html">psa_crypto_driver_pake_inputs_s</a> {</div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;    uint8_t *MBEDTLS_PRIVATE(password);</div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;    <span class="keywordtype">size_t</span> MBEDTLS_PRIVATE(password_len);</div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;    uint8_t *MBEDTLS_PRIVATE(user);</div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;    <span class="keywordtype">size_t</span> MBEDTLS_PRIVATE(user_len);</div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;    uint8_t *MBEDTLS_PRIVATE(peer);</div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;    <span class="keywordtype">size_t</span> MBEDTLS_PRIVATE(peer_len);</div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;    <a class="code" href="structpsa__key__attributes__s.html">psa_key_attributes_t</a> MBEDTLS_PRIVATE(attributes);</div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;    <a class="code" href="structpsa__pake__cipher__suite__s.html">psa_pake_cipher_suite_t</a> MBEDTLS_PRIVATE(cipher_suite);</div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;};</div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160; </div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;<span class="keyword">typedef</span> <span class="keyword">enum</span> psa_crypto_driver_pake_step {</div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;    PSA_JPAKE_STEP_INVALID        = 0,  <span class="comment">/* Invalid step */</span></div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;    PSA_JPAKE_X1_STEP_KEY_SHARE   = 1,  <span class="comment">/* Round 1: input/output key share (for ephemeral private key X1).*/</span></div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;    PSA_JPAKE_X1_STEP_ZK_PUBLIC   = 2,  <span class="comment">/* Round 1: input/output Schnorr NIZKP public key for the X1 key */</span></div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;    PSA_JPAKE_X1_STEP_ZK_PROOF    = 3,  <span class="comment">/* Round 1: input/output Schnorr NIZKP proof for the X1 key */</span></div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;    PSA_JPAKE_X2_STEP_KEY_SHARE   = 4,  <span class="comment">/* Round 1: input/output key share (for ephemeral private key X2).*/</span></div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;    PSA_JPAKE_X2_STEP_ZK_PUBLIC   = 5,  <span class="comment">/* Round 1: input/output Schnorr NIZKP public key for the X2 key */</span></div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;    PSA_JPAKE_X2_STEP_ZK_PROOF    = 6,  <span class="comment">/* Round 1: input/output Schnorr NIZKP proof for the X2 key */</span></div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;    PSA_JPAKE_X2S_STEP_KEY_SHARE  = 7,  <span class="comment">/* Round 2: output X2S key (our key) */</span></div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;    PSA_JPAKE_X2S_STEP_ZK_PUBLIC  = 8,  <span class="comment">/* Round 2: output Schnorr NIZKP public key for the X2S key (our key) */</span></div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;    PSA_JPAKE_X2S_STEP_ZK_PROOF   = 9,  <span class="comment">/* Round 2: output Schnorr NIZKP proof for the X2S key (our key) */</span></div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;    PSA_JPAKE_X4S_STEP_KEY_SHARE  = 10, <span class="comment">/* Round 2: input X4S key (from peer) */</span></div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;    PSA_JPAKE_X4S_STEP_ZK_PUBLIC  = 11, <span class="comment">/* Round 2: input Schnorr NIZKP public key for the X4S key (from peer) */</span></div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;    PSA_JPAKE_X4S_STEP_ZK_PROOF   = 12  <span class="comment">/* Round 2: input Schnorr NIZKP proof for the X4S key (from peer) */</span></div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;} psa_crypto_driver_pake_step_t;</div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160; </div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;<span class="keyword">typedef</span> <span class="keyword">enum</span> psa_jpake_round {</div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;    PSA_JPAKE_FIRST = 0,</div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;    PSA_JPAKE_SECOND = 1,</div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;    PSA_JPAKE_FINISHED = 2</div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;} psa_jpake_round_t;</div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160; </div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;<span class="keyword">typedef</span> <span class="keyword">enum</span> psa_jpake_io_mode {</div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;    PSA_JPAKE_INPUT = 0,</div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;    PSA_JPAKE_OUTPUT = 1</div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;} psa_jpake_io_mode_t;</div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160; </div>
<div class="line"><a name="l01825"></a><span class="lineno"><a class="line" href="structpsa__jpake__computation__stage__s.html"> 1825</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structpsa__jpake__computation__stage__s.html">psa_jpake_computation_stage_s</a> {</div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;    <span class="comment">/* The J-PAKE round we are currently on */</span></div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;    psa_jpake_round_t MBEDTLS_PRIVATE(round);</div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;    <span class="comment">/* The &#39;mode&#39; we are currently in (inputting or outputting) */</span></div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;    psa_jpake_io_mode_t MBEDTLS_PRIVATE(io_mode);</div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;    <span class="comment">/* The number of completed inputs so far this round */</span></div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;    uint8_t MBEDTLS_PRIVATE(inputs);</div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;    <span class="comment">/* The number of completed outputs so far this round */</span></div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;    uint8_t MBEDTLS_PRIVATE(outputs);</div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;    <span class="comment">/* The next expected step (KEY_SHARE, ZK_PUBLIC or ZK_PROOF) */</span></div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;    <a class="code" href="group__pake.html#gac16be59e5b1acb89c26709eed001ef35">psa_pake_step_t</a> MBEDTLS_PRIVATE(step);</div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;};</div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160; </div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;<span class="preprocessor">#define PSA_JPAKE_EXPECTED_INPUTS(round) ((round) == PSA_JPAKE_FINISHED ? 0 : \</span></div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;<span class="preprocessor">                                          ((round) == PSA_JPAKE_FIRST ? 2 : 1))</span></div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;<span class="preprocessor">#define PSA_JPAKE_EXPECTED_OUTPUTS(round) ((round) == PSA_JPAKE_FINISHED ? 0 : \</span></div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;<span class="preprocessor">                                           ((round) == PSA_JPAKE_FIRST ? 2 : 1))</span></div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160; </div>
<div class="line"><a name="l01843"></a><span class="lineno"><a class="line" href="structpsa__pake__operation__s.html"> 1843</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structpsa__pake__operation__s.html">psa_pake_operation_s</a> {</div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;<span class="preprocessor">#if defined(MBEDTLS_PSA_CRYPTO_CLIENT) &amp;&amp; !defined(MBEDTLS_PSA_CRYPTO_C)</span></div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;    mbedtls_psa_client_handle_t handle;</div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160; </div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="structpsa__pake__operation__s.html#ae68009766622d2bfcdaee53ad037c28d">MBEDTLS_PRIVATE</a>(<span class="keywordtype">id</span>);</div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;    <span class="comment">/* Algorithm of the PAKE operation */</span></div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;    <a class="code" href="group__crypto__types.html#gac2e4d47f1300d73c2f829a6d99252d69">psa_algorithm_t</a> <a class="code" href="structpsa__pake__operation__s.html#ae68009766622d2bfcdaee53ad037c28d">MBEDTLS_PRIVATE</a>(alg);</div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;    <span class="comment">/* A primitive of type compatible with algorithm */</span></div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;    <a class="code" href="group__pake.html#ga37ed4ea6bba6bacc72d0ecb9b95af96c">psa_pake_primitive_t</a> <a class="code" href="structpsa__pake__operation__s.html#ae68009766622d2bfcdaee53ad037c28d">MBEDTLS_PRIVATE</a>(primitive);</div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;    <span class="comment">/* Stage of the PAKE operation: waiting for the setup, collecting inputs</span></div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;<span class="comment">     * or computing. */</span></div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;    uint8_t <a class="code" href="structpsa__pake__operation__s.html#ae68009766622d2bfcdaee53ad037c28d">MBEDTLS_PRIVATE</a>(stage);</div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;    <span class="comment">/* Holds computation stage of the PAKE algorithms. */</span></div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;    <span class="keyword">union </span>{</div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;        uint8_t <a class="code" href="structpsa__pake__operation__s.html#ae68009766622d2bfcdaee53ad037c28d">MBEDTLS_PRIVATE</a>(dummy);</div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;<span class="preprocessor">#if defined(PSA_WANT_ALG_JPAKE)</span></div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;        <a class="code" href="structpsa__jpake__computation__stage__s.html">psa_jpake_computation_stage_t</a> <a class="code" href="structpsa__pake__operation__s.html#ae68009766622d2bfcdaee53ad037c28d">MBEDTLS_PRIVATE</a>(jpake);</div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;    } <a class="code" href="structpsa__pake__operation__s.html#ae68009766622d2bfcdaee53ad037c28d">MBEDTLS_PRIVATE</a>(computation_stage);</div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;    <span class="keyword">union </span>{</div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;        <a class="code" href="unionpsa__driver__pake__context__t.html">psa_driver_pake_context_t</a> <a class="code" href="structpsa__pake__operation__s.html#ae68009766622d2bfcdaee53ad037c28d">MBEDTLS_PRIVATE</a>(ctx);</div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;        <a class="code" href="structpsa__crypto__driver__pake__inputs__s.html">psa_crypto_driver_pake_inputs_t</a> <a class="code" href="structpsa__pake__operation__s.html#ae68009766622d2bfcdaee53ad037c28d">MBEDTLS_PRIVATE</a>(inputs);</div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;    } <a class="code" href="structpsa__pake__operation__s.html#ae68009766622d2bfcdaee53ad037c28d">MBEDTLS_PRIVATE</a>(data);</div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;};</div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160; </div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keyword">struct </span><a class="code" href="structpsa__pake__cipher__suite__s.html">psa_pake_cipher_suite_s</a> psa_pake_cipher_suite_init(void)</div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;{</div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;    <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structpsa__pake__cipher__suite__s.html">psa_pake_cipher_suite_s</a> v = <a class="code" href="crypto__extra_8h.html#a78e33eb5906aa452ca64159191c2d975">PSA_PAKE_CIPHER_SUITE_INIT</a>;</div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;    <span class="keywordflow">return</span> v;</div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;}</div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160; </div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keyword">struct </span><a class="code" href="structpsa__pake__operation__s.html">psa_pake_operation_s</a> psa_pake_operation_init(void)</div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;{</div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;    <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structpsa__pake__operation__s.html">psa_pake_operation_s</a> v = <a class="code" href="crypto__extra_8h.html#a0ce235183de6d1a0744b00ced5be7c74">PSA_PAKE_OPERATION_INIT</a>;</div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;    <span class="keywordflow">return</span> v;</div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;}</div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160; </div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;<span class="preprocessor">#ifdef __cplusplus</span></div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;}</div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160; </div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* PSA_CRYPTO_EXTRA_H */</span><span class="preprocessor"></span></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="acrypto__extra_8h_html_a00f4837e0253580c83b4d93ea91aa48b"><div class="ttname"><a href="crypto__extra_8h.html#a00f4837e0253580c83b4d93ea91aa48b">mbedtls_psa_crypto_free</a></div><div class="ttdeci">void mbedtls_psa_crypto_free(void)</div><div class="ttdoc">Library deinitialization.</div></div>
<div class="ttc" id="agroup__pake_html_ga8fe36328c35f9f8b399492d369ab5d1d"><div class="ttname"><a href="group__pake.html#ga8fe36328c35f9f8b399492d369ab5d1d">psa_crypto_driver_pake_get_password_len</a></div><div class="ttdeci">psa_status_t psa_crypto_driver_pake_get_password_len(const psa_crypto_driver_pake_inputs_t *inputs, size_t *password_len)</div></div>
<div class="ttc" id="acrypto__extra_8h_html_a0ce235183de6d1a0744b00ced5be7c74"><div class="ttname"><a href="crypto__extra_8h.html#a0ce235183de6d1a0744b00ced5be7c74">PSA_PAKE_OPERATION_INIT</a></div><div class="ttdeci">#define PSA_PAKE_OPERATION_INIT</div><div class="ttdef"><b>Definition:</b> crypto_extra.h:1714</div></div>
<div class="ttc" id="agroup__pake_html_gaf61d9d1549d4f3eeaf891dd73354db66"><div class="ttname"><a href="group__pake.html#gaf61d9d1549d4f3eeaf891dd73354db66">psa_pake_set_role</a></div><div class="ttdeci">psa_status_t psa_pake_set_role(psa_pake_operation_t *operation, psa_pake_role_t role)</div></div>
<div class="ttc" id="agroup__error_html_ga05676e70ba5c6a7565aff3c36677c1f9"><div class="ttname"><a href="group__error.html#ga05676e70ba5c6a7565aff3c36677c1f9">psa_status_t</a></div><div class="ttdeci">int32_t psa_status_t</div><div class="ttdoc">Function return status.</div><div class="ttdef"><b>Definition:</b> crypto_types.h:59</div></div>
<div class="ttc" id="agroup__pake_html_gab1769b1b1a85111973e8d0c9cced95de"><div class="ttname"><a href="group__pake.html#gab1769b1b1a85111973e8d0c9cced95de">psa_pake_role_t</a></div><div class="ttdeci">uint8_t psa_pake_role_t</div><div class="ttdoc">Encoding of the application role of PAKE.</div><div class="ttdef"><b>Definition:</b> crypto_extra.h:731</div></div>
<div class="ttc" id="agroup__crypto__types_html_ga947bd13805e0243541e586b7b7d803ae"><div class="ttname"><a href="group__crypto__types.html#ga947bd13805e0243541e586b7b7d803ae">PSA_ALG_IS_PAKE</a></div><div class="ttdeci">#define PSA_ALG_IS_PAKE(alg)</div><div class="ttdef"><b>Definition:</b> crypto_extra.h:591</div></div>
<div class="ttc" id="agroup__pake_html_gac21aace2d63ba9766e8266e3bd782d12"><div class="ttname"><a href="group__pake.html#gac21aace2d63ba9766e8266e3bd782d12">psa_crypto_driver_pake_get_peer</a></div><div class="ttdeci">psa_status_t psa_crypto_driver_pake_get_peer(const psa_crypto_driver_pake_inputs_t *inputs, uint8_t *peer_id, size_t peer_id_size, size_t *peer_id_length)</div></div>
<div class="ttc" id="agroup__pake_html_ga35af752a83762fe23daa47e3ddef3a68"><div class="ttname"><a href="group__pake.html#ga35af752a83762fe23daa47e3ddef3a68">psa_pake_input</a></div><div class="ttdeci">psa_status_t psa_pake_input(psa_pake_operation_t *operation, psa_pake_step_t step, const uint8_t *input, size_t input_length)</div></div>
<div class="ttc" id="astructpsa__key__attributes__s_html"><div class="ttname"><a href="structpsa__key__attributes__s.html">psa_key_attributes_s</a></div><div class="ttdef"><b>Definition:</b> crypto_struct.h:295</div></div>
<div class="ttc" id="agroup__pake_html_gae0a816b989d5ee3a6b3fe8ceac544875"><div class="ttname"><a href="group__pake.html#gae0a816b989d5ee3a6b3fe8ceac544875">psa_crypto_driver_pake_get_user_len</a></div><div class="ttdeci">psa_status_t psa_crypto_driver_pake_get_user_len(const psa_crypto_driver_pake_inputs_t *inputs, size_t *user_len)</div></div>
<div class="ttc" id="agroup__pake_html_gac16be59e5b1acb89c26709eed001ef35"><div class="ttname"><a href="group__pake.html#gac16be59e5b1acb89c26709eed001ef35">psa_pake_step_t</a></div><div class="ttdeci">uint8_t psa_pake_step_t</div><div class="ttdef"><b>Definition:</b> crypto_extra.h:739</div></div>
<div class="ttc" id="agroup__pake_html_gae1e7c28c10bf767f4b6927f820740103"><div class="ttname"><a href="group__pake.html#gae1e7c28c10bf767f4b6927f820740103">psa_pake_get_implicit_key</a></div><div class="ttdeci">psa_status_t psa_pake_get_implicit_key(psa_pake_operation_t *operation, psa_key_derivation_operation_t *output)</div></div>
<div class="ttc" id="agroup__pake_html_ga45e914c064160f4fe1d511f9d0506400"><div class="ttname"><a href="group__pake.html#ga45e914c064160f4fe1d511f9d0506400">psa_pake_setup</a></div><div class="ttdeci">psa_status_t psa_pake_setup(psa_pake_operation_t *operation, const psa_pake_cipher_suite_t *cipher_suite)</div></div>
<div class="ttc" id="agroup__pake_html_gadcf0335780b48a4851780807e115b20e"><div class="ttname"><a href="group__pake.html#gadcf0335780b48a4851780807e115b20e">psa_crypto_driver_pake_get_peer_len</a></div><div class="ttdeci">psa_status_t psa_crypto_driver_pake_get_peer_len(const psa_crypto_driver_pake_inputs_t *inputs, size_t *peer_len)</div></div>
<div class="ttc" id="acrypto__extra_8h_html_af4f09c8f08db9e2d881f465c432a300d"><div class="ttname"><a href="crypto__extra_8h.html#af4f09c8f08db9e2d881f465c432a300d">mbedtls_psa_inject_entropy</a></div><div class="ttdeci">psa_status_t mbedtls_psa_inject_entropy(const uint8_t *seed, size_t seed_size)</div><div class="ttdoc">Inject an initial entropy seed for the random generator into secure storage.</div></div>
<div class="ttc" id="acrypto__extra_8h_html_aa4d160ae9c02a60317702832a828e4b7"><div class="ttname"><a href="crypto__extra_8h.html#aa4d160ae9c02a60317702832a828e4b7">mbedtls_psa_get_stats</a></div><div class="ttdeci">void mbedtls_psa_get_stats(mbedtls_psa_stats_t *stats)</div><div class="ttdoc">Get statistics about resource consumption related to the PSA keystore.</div></div>
<div class="ttc" id="agroup__key__lifetimes_html_ga11e986351c65bd3dc3c0fe2cd9926e4b"><div class="ttname"><a href="group__key__lifetimes.html#ga11e986351c65bd3dc3c0fe2cd9926e4b">psa_key_id_t</a></div><div class="ttdeci">uint32_t psa_key_id_t</div><div class="ttdef"><b>Definition:</b> crypto_types.h:275</div></div>
<div class="ttc" id="agroup__pake_html_ga37ed4ea6bba6bacc72d0ecb9b95af96c"><div class="ttname"><a href="group__pake.html#ga37ed4ea6bba6bacc72d0ecb9b95af96c">psa_pake_primitive_t</a></div><div class="ttdeci">uint32_t psa_pake_primitive_t</div><div class="ttdoc">Encoding of the primitive associated with the PAKE.</div><div class="ttdef"><b>Definition:</b> crypto_extra.h:762</div></div>
<div class="ttc" id="agroup__pake_html_gae20cc74390755f28b6f2b893a936d893"><div class="ttname"><a href="group__pake.html#gae20cc74390755f28b6f2b893a936d893">psa_pake_family_t</a></div><div class="ttdeci">uint8_t psa_pake_family_t</div><div class="ttdoc">Encoding of the family of the primitive associated with the PAKE.</div><div class="ttdef"><b>Definition:</b> crypto_extra.h:756</div></div>
<div class="ttc" id="agroup__pake_html_gaf49527ceec65d3927f4ef2a589bade04"><div class="ttname"><a href="group__pake.html#gaf49527ceec65d3927f4ef2a589bade04">PSA_PAKE_PRIMITIVE</a></div><div class="ttdeci">#define PSA_PAKE_PRIMITIVE(pake_type, pake_family, pake_bits)</div><div class="ttdef"><b>Definition:</b> crypto_extra.h:859</div></div>
<div class="ttc" id="acrypto__types_8h_html"><div class="ttname"><a href="crypto__types_8h.html">crypto_types.h</a></div><div class="ttdoc">PSA cryptography module: type aliases.</div></div>
<div class="ttc" id="agroup__pake_html_gad8b29b6efa90ad2887d7b1252d23e5bc"><div class="ttname"><a href="group__pake.html#gad8b29b6efa90ad2887d7b1252d23e5bc">psa_pake_primitive_type_t</a></div><div class="ttdeci">uint8_t psa_pake_primitive_type_t</div><div class="ttdef"><b>Definition:</b> crypto_extra.h:749</div></div>
<div class="ttc" id="agroup__psa__builtin__keys_html_gaa0cdcd889aaaca7d78c378deb1e14353"><div class="ttname"><a href="group__psa__builtin__keys.html#gaa0cdcd889aaaca7d78c378deb1e14353">MBEDTLS_PSA_KEY_ID_BUILTIN_MIN</a></div><div class="ttdeci">#define MBEDTLS_PSA_KEY_ID_BUILTIN_MIN</div><div class="ttdef"><b>Definition:</b> crypto_extra.h:493</div></div>
<div class="ttc" id="agroup__pake_html_gaeeeb55c935dc95819bae1378de462593"><div class="ttname"><a href="group__pake.html#gaeeeb55c935dc95819bae1378de462593">psa_crypto_driver_pake_get_user</a></div><div class="ttdeci">psa_status_t psa_crypto_driver_pake_get_user(const psa_crypto_driver_pake_inputs_t *inputs, uint8_t *user_id, size_t user_id_size, size_t *user_id_len)</div></div>
<div class="ttc" id="agroup__pake_html_ga070417b83e6d602e9a6cc6748a14ea91"><div class="ttname"><a href="group__pake.html#ga070417b83e6d602e9a6cc6748a14ea91">psa_pake_set_password_key</a></div><div class="ttdeci">psa_status_t psa_pake_set_password_key(psa_pake_operation_t *operation, mbedtls_svc_key_id_t password)</div></div>
<div class="ttc" id="agroup__pake_html_gafb67c744b4ef6615dce729b6c88b9638"><div class="ttname"><a href="group__pake.html#gafb67c744b4ef6615dce729b6c88b9638">psa_crypto_driver_pake_get_cipher_suite</a></div><div class="ttdeci">psa_status_t psa_crypto_driver_pake_get_cipher_suite(const psa_crypto_driver_pake_inputs_t *inputs, psa_pake_cipher_suite_t *cipher_suite)</div></div>
<div class="ttc" id="agroup__crypto__types_html_gac9280662bb482590b4b33d1dcd32930f"><div class="ttname"><a href="group__crypto__types.html#gac9280662bb482590b4b33d1dcd32930f">PSA_ALG_IS_HASH</a></div><div class="ttdeci">#define PSA_ALG_IS_HASH(alg)</div><div class="ttdef"><b>Definition:</b> crypto_values.h:808</div></div>
<div class="ttc" id="acrypto__compat_8h_html"><div class="ttname"><a href="crypto__compat_8h.html">crypto_compat.h</a></div><div class="ttdoc">PSA cryptography module: Backward compatibility aliases.</div></div>
<div class="ttc" id="astructmbedtls__psa__stats__s_html_a7e4edf3d1ccd20d2b5d5bf1dc6255a97"><div class="ttname"><a href="structmbedtls__psa__stats__s.html#a7e4edf3d1ccd20d2b5d5bf1dc6255a97">mbedtls_psa_stats_s::MBEDTLS_PRIVATE</a></div><div class="ttdeci">size_t MBEDTLS_PRIVATE(volatile_slots)</div></div>
<div class="ttc" id="astructpsa__jpake__computation__stage__s_html"><div class="ttname"><a href="structpsa__jpake__computation__stage__s.html">psa_jpake_computation_stage_s</a></div><div class="ttdef"><b>Definition:</b> crypto_extra.h:1825</div></div>
<div class="ttc" id="acrypto__extra_8h_html_a78e33eb5906aa452ca64159191c2d975"><div class="ttname"><a href="crypto__extra_8h.html#a78e33eb5906aa452ca64159191c2d975">PSA_PAKE_CIPHER_SUITE_INIT</a></div><div class="ttdeci">#define PSA_PAKE_CIPHER_SUITE_INIT</div><div class="ttdef"><b>Definition:</b> crypto_extra.h:1706</div></div>
<div class="ttc" id="agroup__se__init_html_ga90828ba6e282dd39260c81af68532e1d"><div class="ttname"><a href="group__se__init.html#ga90828ba6e282dd39260c81af68532e1d">psa_key_slot_number_t</a></div><div class="ttdeci">uint64_t psa_key_slot_number_t</div><div class="ttdef"><b>Definition:</b> crypto_se_driver.h:137</div></div>
<div class="ttc" id="astructpsa__pake__cipher__suite__s_html"><div class="ttname"><a href="structpsa__pake__cipher__suite__s.html">psa_pake_cipher_suite_s</a></div><div class="ttdef"><b>Definition:</b> crypto_extra.h:1718</div></div>
<div class="ttc" id="agroup__psa__builtin__keys_html_ga0af04ffbbc3f6bc08562381205b8ef5e"><div class="ttname"><a href="group__psa__builtin__keys.html#ga0af04ffbbc3f6bc08562381205b8ef5e">MBEDTLS_PSA_KEY_ID_BUILTIN_MAX</a></div><div class="ttdeci">#define MBEDTLS_PSA_KEY_ID_BUILTIN_MAX</div><div class="ttdef"><b>Definition:</b> crypto_extra.h:500</div></div>
<div class="ttc" id="astructpsa__crypto__driver__pake__inputs__s_html"><div class="ttname"><a href="structpsa__crypto__driver__pake__inputs__s.html">psa_crypto_driver_pake_inputs_s</a></div><div class="ttdef"><b>Definition:</b> crypto_extra.h:1787</div></div>
<div class="ttc" id="agroup__pake_html_ga2476026b61583d8e9321256e5bfe5392"><div class="ttname"><a href="group__pake.html#ga2476026b61583d8e9321256e5bfe5392">psa_crypto_driver_pake_get_password</a></div><div class="ttdeci">psa_status_t psa_crypto_driver_pake_get_password(const psa_crypto_driver_pake_inputs_t *inputs, uint8_t *buffer, size_t buffer_size, size_t *buffer_length)</div></div>
<div class="ttc" id="agroup__crypto__types_html_gac2e4d47f1300d73c2f829a6d99252d69"><div class="ttname"><a href="group__crypto__types.html#gac2e4d47f1300d73c2f829a6d99252d69">psa_algorithm_t</a></div><div class="ttdeci">uint32_t psa_algorithm_t</div><div class="ttdoc">Encoding of a cryptographic algorithm.</div><div class="ttdef"><b>Definition:</b> crypto_types.h:134</div></div>
<div class="ttc" id="acrypto__extra_8h_html_aa9b95eb371f975f041d50f1a662357fe"><div class="ttname"><a href="crypto__extra_8h.html#aa9b95eb371f975f041d50f1a662357fe">mbedtls_psa_stats_t</a></div><div class="ttdeci">struct mbedtls_psa_stats_s mbedtls_psa_stats_t</div><div class="ttdoc">Statistics about resource consumption related to the PSA keystore.</div></div>
<div class="ttc" id="agroup__key__lifetimes_html_ga9a5375bd0cb9694f3a2694adc0a6ae13"><div class="ttname"><a href="group__key__lifetimes.html#ga9a5375bd0cb9694f3a2694adc0a6ae13">mbedtls_svc_key_id_t</a></div><div class="ttdeci">psa_key_id_t mbedtls_svc_key_id_t</div><div class="ttdef"><b>Definition:</b> crypto_types.h:292</div></div>
<div class="ttc" id="astructpsa__pake__operation__s_html"><div class="ttname"><a href="structpsa__pake__operation__s.html">psa_pake_operation_s</a></div><div class="ttdef"><b>Definition:</b> crypto_extra.h:1843</div></div>
<div class="ttc" id="astructpsa__pake__operation__s_html_ae68009766622d2bfcdaee53ad037c28d"><div class="ttname"><a href="structpsa__pake__operation__s.html#ae68009766622d2bfcdaee53ad037c28d">psa_pake_operation_s::MBEDTLS_PRIVATE</a></div><div class="ttdeci">unsigned int MBEDTLS_PRIVATE(id)</div></div>
<div class="ttc" id="agroup__pake_html_gabae9a3e54d1c895032a4ee543b494958"><div class="ttname"><a href="group__pake.html#gabae9a3e54d1c895032a4ee543b494958">psa_pake_set_peer</a></div><div class="ttdeci">psa_status_t psa_pake_set_peer(psa_pake_operation_t *operation, const uint8_t *peer_id, size_t peer_id_len)</div></div>
<div class="ttc" id="aunionpsa__driver__pake__context__t_html"><div class="ttname"><a href="unionpsa__driver__pake__context__t.html">psa_driver_pake_context_t</a></div><div class="ttdef"><b>Definition:</b> crypto_driver_contexts_composites.h:141</div></div>
<div class="ttc" id="astructmbedtls__psa__stats__s_html"><div class="ttname"><a href="structmbedtls__psa__stats__s.html">mbedtls_psa_stats_s</a></div><div class="ttdoc">Statistics about resource consumption related to the PSA keystore.</div><div class="ttdef"><b>Definition:</b> crypto_extra.h:221</div></div>
<div class="ttc" id="agroup__pake_html_ga592e6102db23692862d800f569a8f1fe"><div class="ttname"><a href="group__pake.html#ga592e6102db23692862d800f569a8f1fe">psa_pake_output</a></div><div class="ttdeci">psa_status_t psa_pake_output(psa_pake_operation_t *operation, psa_pake_step_t step, uint8_t *output, size_t output_size, size_t *output_length)</div></div>
<div class="ttc" id="aprivate__access_8h_html"><div class="ttname"><a href="private__access_8h.html">private_access.h</a></div><div class="ttdoc">Macro wrapper for struct's members.</div></div>
<div class="ttc" id="agroup__key__lifetimes_html_ga6821ff6dd39dc2bc370ded760ad8b0cf"><div class="ttname"><a href="group__key__lifetimes.html#ga6821ff6dd39dc2bc370ded760ad8b0cf">psa_key_lifetime_t</a></div><div class="ttdeci">uint32_t psa_key_lifetime_t</div><div class="ttdef"><b>Definition:</b> crypto_types.h:183</div></div>
<div class="ttc" id="agroup__psa__builtin__keys_html_ga1eb805bebc295cc2f7132679fa85d43d"><div class="ttname"><a href="group__psa__builtin__keys.html#ga1eb805bebc295cc2f7132679fa85d43d">psa_drv_slot_number_t</a></div><div class="ttdeci">uint64_t psa_drv_slot_number_t</div><div class="ttdef"><b>Definition:</b> crypto_extra.h:506</div></div>
<div class="ttc" id="astructpsa__key__derivation__s_html"><div class="ttname"><a href="structpsa__key__derivation__s.html">psa_key_derivation_s</a></div><div class="ttdef"><b>Definition:</b> crypto_struct.h:202</div></div>
<div class="ttc" id="agroup__pake_html_ga64fe9f62b09d39056e169325a9d33aac"><div class="ttname"><a href="group__pake.html#ga64fe9f62b09d39056e169325a9d33aac">psa_pake_set_user</a></div><div class="ttdeci">psa_status_t psa_pake_set_user(psa_pake_operation_t *operation, const uint8_t *user_id, size_t user_id_len)</div></div>
<div class="ttc" id="agroup__pake_html_ga20bed96cc254d2e1829d666edc74376a"><div class="ttname"><a href="group__pake.html#ga20bed96cc254d2e1829d666edc74376a">psa_pake_abort</a></div><div class="ttdeci">psa_status_t psa_pake_abort(psa_pake_operation_t *operation)</div></div>
<!-- HTML footer for doxygen 1.9.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_2ebe51030033e2c2ea1784a1e8217899.html">generic_psa</a></li><li class="navelem"><a class="el" href="dir_387ca30099ce5e33d3223324d6ac0923.html">include</a></li><li class="navelem"><a class="el" href="dir_3a0e2f904b3c1742b1ef0d377b23adf4.html">mbedtls</a></li><li class="navelem"><a class="el" href="dir_83321844a67635f8150b8bd739c52b53.html">include</a></li><li class="navelem"><a class="el" href="dir_c94d002f3238534dcd3d5725f95aa49c.html">psa</a></li><li class="navelem"><a class="el" href="crypto__extra_8h.html">crypto_extra.h</a></li>
    <li class="footer"><b></b>
    Copyright &copy; 2023-2024 Nagravision S&agrave;rl.
	- Generated on Mon Aug 25 2025 11:20:05 for SAL API by <a href="https://www.doxygen.org/index.html" target="_new">doxygen</a> 1.8.17</li>
  </ul>
</div>
</body>
</html>